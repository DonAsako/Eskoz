{% extends 'base.html' %}
{% load i18n %}
{% block head %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.css" integrity="sha384-WcoG4HRXMzYzfCgiyfrySxx90XSl2rxY5mnVY5TwtWE6KLrArNKn0T/mOgNL0Mmi" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/katex.min.js" integrity="sha384-J+9dG2KMoiR9hqcFao0IBLwxt6zpcyN68IgwzsCSkbreXUjmNVRhPFTssqdSGjwQ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.25/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
        onload="renderMathInElement(document.querySelector('.article--content'));"></script>
{% load static %}
{% with markdown_css=ACTIVE_THEME|add:"/css/markdown.css" %}
    <link rel="stylesheet" href="{% static markdown_css %}">
{% endwith %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/vs.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" integrity="sha512-EBLzUL8XLl+va/zAsmXwS7Z2B1F9HUHkZwyS/VKwh3S7T/U0nF4BaU29EP/ZSf6zgiIxYAnKLu6bJ8dqpmX5uw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
{% endblock %}
{% block title %} - {{ lesson.get_translation.title }}{% endblock %}
{% block SEO %}
    <meta property="og:type" content="article" />
    <meta property="article:published_time" content="{{ lesson.created_on.isoformat }}" />
{% endblock %}
{% block content %}
<div class="article--container">
    <div class="article--wrapper">
        <div class="article--header">
            <h1>{{ lesson.get_translation.title }}</h1>
            <div class="article--meta">
                {% if lesson.get_translation.get_reading_time %}
                <span class="article--meta-item">
                    üìñ {{ lesson.get_translation.get_reading_time }} min {% trans "read" %}
                </span>
                {% endif %}
                <span class="article--meta-item">
                    üìö {{ course.title }} ‚Ä∫ {{ module.title }}
                </span>
            </div>
        </div>
        {% if lesson.picture %}
        <div class="article--picture-wrapper">
            <img src="{{ lesson.picture.url }}" alt="{{ lesson.get_translation.title }}">
        </div>
        {% endif %}
        <div class="article--content markdown-body">
            {{ lesson.get_translation.get_content_as_html }}
        </div>

        <div class="lesson-navigation">
            {% if previous_lesson %}
            <a href="{% url 'education:lesson_detail' course.slug module.slug previous_lesson.slug %}" class="lesson-nav-btn">
                ‚Üê {{ previous_lesson.get_translation.title|truncatechars:30 }}
            </a>
            {% else %}
            <span></span>
            {% endif %}

            <button class="mark-read-btn" data-lesson="{{ lesson.slug }}">
                <span>‚óã</span> {% trans "Mark as read" %}
            </button>

            {% if next_lesson %}
            <a href="{% url 'education:lesson_detail' course.slug module.slug next_lesson.slug %}" class="lesson-nav-btn">
                {{ next_lesson.get_translation.title|truncatechars:30 }} ‚Üí
            </a>
            {% else %}
            <span></span>
            {% endif %}
        </div>
    </div>
    {% include 'components/toc.html' %}
</div>
<script>
    hljs.highlightAll();
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "\\[", right: "\\]", display: true},
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false},
                {left: "\\(", right: "\\)", display: false}
            ]
        });
    });
</script>
{% endblock %}
